# Тестовое задание для МассПроект

## Эндпоинты

### 1. Создание заявки
**Метод**: `POST`
**Эндпоинт**: `/requests`

#### Описание
Создает новую заявку.

#### Тело запроса
```json
{
  "name": "string",
  "email": "string",
  "description": "string"
}
```

#### Ответ
- **Успех**: Возвращает созданный объект заявки.
- **Ошибка**: Возвращает ошибки валидации.

---

### 2. Получение заявок
**Метод**: `GET`
**Эндпоинт**: `/requests`

#### Описание
Получает список заявок с опциональными фильтрами.

#### Параметры запроса
- `status`: Фильтр по статусу заявки.
- `date_from`: Фильтр по дате создания (начало).
- `date_to`: Фильтр по дате создания (конец).

#### Ответ
- **Успех**: Возвращает список подходящих заявок.
- **Ошибка**: Возвращает ошибки валидации или сообщение об ошибке.

---

### 3. Обновление заявки
**Метод**: `PUT`
**Эндпоинт**: `/requests/{id}`

#### Описание
Обновляет указанную заявку.

#### Тело запроса
```json
{
  "comment": "string"
}
```

#### Ответ
- **Успех**: Возвращает обновленный объект заявки.
- **Ошибка**: Возвращает ошибки валидации или сообщение об ошибке, если заявка уже обработана.

---

### 4. Обработка ошибок
**Метод**: Автоматически
**Эндпоинт**: `/error`

#### Описание
Обрабатывает и форматирует ошибки приложения.

#### Ответ
```json
{
  "error": true,
  "message": "string",
  "code": "integer"
}
```

---

## Детали реализации

### Зависимости
- **Yii2 Framework**: Необходим для работы приложения.
- **MailService**: Используется для отправки уведомлений по электронной почте.

### Модели
- **Request**: Представляет данные заявки.
- **RequestFilterForm**: Обрабатывает логику фильтрации для получения заявок.

### Поведения
- **CORS Filter**: Настраивает кросс-доменные запросы.
- **Access Control**: Ограничивает доступ к определенным эндпоинтам.

---

## Инструкции по настройке

1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/vgjtnswms/requests-api.git
   cd requests-api
   ```

2. Установите зависимости:
   ```bash
   composer install
   ```

3. Настройте подключение к базе данных в `config/db.php`.

4. Выполните миграции для создания необходимых таблиц:
   ```bash
   php yii migrate
   ```

5. Настройте MailService с данными вашего почтового сервера.

---

## Инструкции по тестированию

1. Запустите сервер разработки:
   ```bash
   php yii serve
   ```

2. Используйте инструменты, такие как Postman или cURL, для тестирования эндпоинтов:
   - Создание заявки: `POST /requests`
   - Получение заявок: `GET /requests`
   - Обновление заявки: `PUT /requests/{id}`

3. Проверьте уведомления по электронной почте для обновленных заявок (runtime/mail).

